
## Andel av alkoholbruk siste år 

```{r}
#| echo: false
#| warning: false

DD[year == 2018, drukket1 := ifelse(drukket1 == 0, 2, drukket1)]
DD[, alkosistaar := ifelse(drukket1 %in% 8:9, NA, drukket1)]

DD[year %in% c(2022,2024), kjonn := fcase(kjonn == 1, 2, #Kvinne
                                          kjonn == 0, 1)] #Mann

alkosistaar_values <- c(
  "drukket alkohol siste 12 mnd" = 1,
  "ikke drukket alkohol siste 12 mnd" = 2
)


alkDD <- split_gender(d = DD, x = "year", y = "alkosistaar", select = 1)

alkoDT <- alkDD$d1 
alkoDTx <- alkDD$d2 

alAllkb <- data.table(v1 = as.integer(alkosistaar_values),
                      v2 = names(alkosistaar_values))

alkoDT[alAllkb, on = c(alkosistaar = "v1"), alkoyr := i.v2]

```

::: {.panel-tabset}
## Figur
```{r}

make_hist(d = alkoDTx,
          x = year,
          y = percentage,
          group = pop,
          n = count,
          title = "Alkoholbruk siste 12 måneder 2012-2024",
          subtitle = "Kilde: Rusundersøkelse 2012-2014 ",
          type = "line",
          flip = FALSE)
```

## Tabell

```{r}
cols <- c("alkosistaar", "sum")
alkoDT[, (cols) := NULL]

colout <- c("alkoyr", "year", "count", "percentage") #Column order
colns <- c(" ", "year", "Antall", "Andel") #Columns rename
setcolorder(alkoDT, colout)
data.table::setnames(alkoDT, colout, colns)

gt::gt(alkoDT)

```
:::


<!-- Alkoholbruk siste år bland menn i ulike aldersgrupper, 2012-2024 -->

```{r}
#| echo: false
#| warning: false
#| output: false

ageBreak <- c(16, 25, 35, 45, 55, 65, Inf)
ageLab <- c("16-24", "25-34", "35-44", "45-54", "55-64", "65+")

group_age(dt = DD, var = "alder", breaks = ageBreak,
          labels = ageLab, new_var = "agecat",
          right = FALSE, missing_values = c(999, 998))


drukkMen <- proscat("year", "alkosistaar", d = DD[kjonn == 1], total = F, z = "agecat")
drukkWom <- proscat("year", "alkosistaar", d = DD[kjonn == 2], total = F, z = "agecat")

```

::: {.panel-tabset}

## Figur
```{r}
make_hist(d = drukkMen[alkosistaar == 1],
          x = year,
          y = percentage,
          group = agecat,
          n = count,
          title = "Alkoholbruk siste år bland menn i ulike aldersgrupper, 2012- 2024",
          type = "line")

```
## Tabell

```{r}
drukkMen
```

:::

<!-- For kvinner -->

::: {.panel-tabset}

## Figur
```{r}
make_hist(d = drukkWom[alkosistaar == 1],
          x = year,
          y = percentage,
          group = agecat,
          n = count,
          title = "Alkoholbruk siste år bland kvinner i ulike aldersgrupper, 2012- 2024",
          subtitle = "Kilde: Rusundersøkelse 2012-2014 ",
          type = "line")

```
## Tabell

```{r}
drukkWom
```
:::


## Andel har drukket 6+ alkoholenheter ved en og samme anledning

Tallene som blir presentert her er for de som har drukket 6+ alkoholenheter
daglig eller ukentlig ved en og samme anledning i det siste året.

```{r}
## Noen koder for Audit er omvent
DD[year %in% 2012:2014,  audit3 := fcase(audit3 == 5, 1,
                                         audit3 == 4, 2,
                                         audit3 == 2, 4,
                                         audit3 == 1, 5,
                                         default = as.numeric(audit3))]

## Omkoding
DD[, drink6w := fcase(audit3 %in% 1:2, 1, #Daglig og ukenlig
                      audit3 %in% 3:4, 2, #månedlig og sjeldenere
                      audit3 == 5, 0, #aldri
                      default = NA)]

drk6 <- split_gender(d=DD, x = "year", y = "drink6w", select = 1)

```


::: {.panel-tabset}

## Figur

```{r}

make_hist(d = drk6$d2, x = year, y = percentage, n = count,  group = pop,
          title = "Drukket 6+ enheter daglig eller ukenlig ved en og samme anledning siste år",
          subtitle = "Kilde: Rusundersøkelse 2012-2014 ",
          type = "line", yint = 2)
```

## Tabell

```{r}

drk6D1 <- drk6$d1
drk6D1[, sum := NULL]

gt::gt(drk6D1)
```

:::


