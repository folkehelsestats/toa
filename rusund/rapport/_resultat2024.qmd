```{r setup-2024}
#| echo: false
#| warning: false

cleanFile <- file.path("rusund", "cleaning", "rus2024", "rus-draft.R")
## Datasettet DD blir laget her
source(file.path(here::here(), cleanFile))

## Global objects for 2024 skal være her
## ------------------------------------
## Vekting
dt[, nyvekt2 := VEKT/mean(VEKT, na.rm = T)]
vekt <- "VEKT" #use global object for weighting

## Gender values
kjonn_values <- c("Menn" = 0, "Kvinner" = 1, "Totalt" = 2)
kjonnkb <- data.table(v1 = as.integer(kjonn_values),
                      v2 = names(kjonn_values))

```

## Andel som har drukket siste år i 2024

```{r cal2-druk}
#| echo: false
#| warning: false

source("analysis2024/drukket-year.R")
```

::: {.panel-tabset}

## Figur

```{r cal2-druk-fig}
make_hist(d = alko,
          x = gender,
          y = percentage,
          group = alkoyr,
          n = count,
          title = "Alkohol siste 12 måneder")
```

## Tabell

```{r cal2-druk-tab}
cols <- c("kj", "alkosistaar", "sum", "weighted_count")
alko[, (cols) := NULL]

colout <- c("alkoyr", "gender", "count", "percentage")
colns <- c(" ", "Kjønn", "Antall", "Andel")
setcolorder(alko, colout)
data.table::setnames(alko, colout, colns, skip_absent = TRUE)

gt::gt(alko)

```
:::


## Drikkefrekvens siste år

```{r cal2-drikk-freq}
#| echo: false
#| warning: false

source("analysis2024/drikk-frekvens.R")
```

::: {.panel-tabset}
## Figur

```{r cal2-drikk-freq-fig}
alkofreq[, alkofrekvens := as.numeric(alkofrekvens)]

make_hist(d = alkofreq,
          x = gender,
          y = percentage,
          group = alkof,
          n = count,
          title = "Drikkerfrekvens siste 12 måneder")

```

## Tabell

```{r cal2-drikk-freq-tab}
cols <- c("kj", "alkofrekvens", "sum")
alkofreq[, (cols) := NULL]

colout <- c("alkof", "gender", "count", "percentage")
colns <- c(" ", "Kjønn", "Antall", "Andel")
setcolorder(alkofreq, colout)
data.table::setnames(alkofreq, colout, colns)

gt::gt(alkofreq)

```

:::


## Andel som har drukket 6+ enheter siste 4 uker 
- En alkoholenhet tilsvarer 0,33 l øl, 1,5 dl vin eller en 4 cl brennevin.
- Andel som har drukket 6+ enheter ved samme anledning minst en gang 4 ukene 


```{r cal2-druk6}
#| echo: false
#| warning: false

source("analysis2024/drikk6.R")

```

::: {.panel-tabset}

## Figur
```{r cal2-druk6-fig}
make_hist(d = drk6_24,
          x = gender,
          y = percentage,
          group = alko,
          n = count,
          title = "Andel drukket 6+ enheter siste 4 uker")
```

## Tabell
```{r cal2-druk6-tab}
cols <- c("kj", "drink6", "sum")
drk6_24[, (cols) := NULL]

colout <- c("alko", "gender", "count", "percentage")
colns <- c(" ", "Kjønn", "Antall", "Andel")
setcolorder(drk6_24, colout)
data.table::setnames(drk6_24, colout, colns)

gt::gt(drk6_24)

```
:::

