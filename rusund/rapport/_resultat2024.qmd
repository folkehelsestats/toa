## Andel som har drukket siste år i 2024

```{r setup-2024}
#| echo: false
#| warning: false

pth2024 <- file.path(here::here(), "rusund", "rapport")
source(file.path(pth2024, "analysis2024/setup2024.R"))

```

```{r cal2-druk}
#| echo: false
#| warning: false

source(file.path(pth2024, "analysis2024/drukket-year.R"))
```

::: {.panel-tabset}

## Figur

```{r cal2-druk-fig}
make_hist(d = alko,
          x = gender,
          y = percentage,
          group = alkoyr,
          n = count,
          title = "Alkohol siste 12 måneder")
```

## Tabell

```{r cal2-druk-tab}
cols <- c("kj", "alkosistaar", "sum", "weighted_count")
alko[, (cols) := NULL]

colout <- c("alkoyr", "gender", "count", "percentage")
colns <- c(" ", "Kjønn", "Antall", "Andel")
setcolorder(alko, colout)
data.table::setnames(alko, colout, colns, skip_absent = TRUE)

gt::gt(alko)
```
:::


## Drikkefrekvens siste år

```{r cal2-drikk-freq}
#| echo: false
#| warning: false

source("analysis2024/drikk-frekvens.R")
```

::: {.panel-tabset}
## Figur

```{r cal2-drikk-freq-fig}
alkofreq[, alkofrekvens := as.numeric(alkofrekvens)]

make_hist(d = alkofreq,
          x = gender,
          y = percentage,
          group = alkof,
          n = count,
          title = "Drikkerfrekvens siste 12 måneder")

```

## Tabell

```{r cal2-drikk-freq-tab}
cols <- c("kj", "alkofrekvens", "sum", "weighted_count")
alkofreq[, (cols) := NULL]

colout <- c("alkof", "gender", "count", "percentage")
colns <- c(" ", "Kjønn", "Antall", "Andel")
setcolorder(alkofreq, colout)
data.table::setnames(alkofreq, colout, colns)

gt::gt(alkofreq)
```

:::


## Andel som har drukket 6+ alkoholenheter ved en og samme anledning siste år


```{r cal2-druk6}
#| echo: false
#| warning: false

source("analysis2024/drikk6.R")
```

::: {.panel-tabset}

## Figur
```{r cal2-druk6-fig}
make_hist(d = drk6_24,
          x = gender,
          y = percentage,
          group = alko,
          n = count,
          title = "Andel drukket 6+ enheter en og samme anledning siste år")
```

## Tabell
```{r cal2-druk6-tab}
cols <- c("kj", "drink6", "sum", "weighted_count")
drk6_24[, (cols) := NULL]

colout <- c("alko", "gender", "count", "percentage")
colns <- c(" ", "Kjønn", "Antall", "Andel")
setcolorder(drk6_24, colout)
data.table::setnames(drk6_24, colout, colns)

gt::gt(drk6_24)
```
:::


## Hvor mye og hva drikker vi?

Beregningen av alkohol typer drukket siste 4 uker.

```{r cal2-drikk-enhet}
#| echo: false
#| warning: false

source(file.path(pth2024,"analysis2024/drikk-enheter.R"))
```

- Ekstreme verdier eg. `r max(dt$halvliteroluke, na.rm=T)` halvliter øl per uke

### Øl halvliter

```{r cal2-drikk-enhet-tab}
#| echo: false
#| warning: false

## 0.5l øl 2.25 cl ren alkohol 

kjonncl <- dt[, round(mean(olcl, na.rm = T)/2.25, digits = 1), keyby = kjonn]
aldercl <- dt[, mean(olcl, na.rm = T)/2.25, keyby = agecat]
alderKjcl <- dt[, mean(olcl, na.rm = T)/2.25, keyby = .(kjonn, agecat)]

aldercl[, kjonn := 2]
tabcl <- data.table::rbindlist(list(aldercl, alderKjcl), use.names = TRUE, ignore.attr = T)
tabcl[, halvliter := round(V1, 1)][, V1 := NULL]

```

Gjennomsnittlig ølkonsum i en fire uke periode i 2024 var `r kjonncl[kjonn == 0, V1]`
halvlitere blant menn og `r kjonncl[kjonn == 1, V1]` blant kvinner.

```{r cal2-drikk-enhet-fig}

tabcl[kjonnkb, on = c(kjonn = "v1"), gender := i.v2]
tabcl[, kjonn := NULL]
data.table::setcolorder(tabcl, c("gender", "agecat", "halvliter"))
gt::gt(tabcl)

## make_hist(d=tabcl,
##           x="agecat",
##           y="halvliter",
##           group = "gender",
##           n = halvliter,
##           title = "Havlitere siste 4 uker")

```
